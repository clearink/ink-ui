var M=Object.defineProperty;var P=(e,s,t)=>s in e?M(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var l=(e,s,t)=>P(e,typeof s!="symbol"?s+"":s,t);import{n as $,B as v}from"./index-CWWohGh8.js";import{J as N,K,g as z,r as p,q as L,L as A,j as o,c as m,w as q,C as H,a as J,b as G,n as T,i as Q,f as I}from"./index-C4-KTeWt.js";import{k as _}from"./keyboard-DDjTZLpe.js";import{u as U}from"./index-Cf2yyT1U.js";import{i as V}from"./is-null-D6OXYL3N.js";import{p as W}from"./pick-BK4giCUn.js";import{O as X}from"./index-DLfVJt-J.js";function Y(e,s=""){e&&e.style.setProperty("display",s==="none"?"":s)}function Z(e){e&&e.style.setProperty("display","none")}const S={position:"fixed",overflow:"hidden",width:0,height:0,top:-1,left:-1,padding:0};function E(e){e&&e.focus({preventScroll:!0})}function ee(e,s){let t=e.nextElementSibling;const r=[];for(;t&&t!==s;)t&&r.push(t),t=(t==null?void 0:t.nextElementSibling)||null;return r}class se{constructor(){l(this,"stack",[]);l(this,"keydownCleanup",$);l(this,"focusinCleanup",$);l(this,"init",s=>{const t=r=>a=>{const n=K(this.stack,-1);n&&n[r](a)};this.keydownCleanup=N(s,"keydown",t("onKeyDown"),!0),this.focusinCleanup=N(s,"focusin",t("onFocusIn"))});l(this,"cleanup",()=>{this.keydownCleanup(),this.focusinCleanup()});l(this,"register",(s,t)=>(this.stack.length||this.init(s),this.stack.push(t),()=>{this.stack=this.stack.filter(r=>r!==t),this.stack.length||this.cleanup()}))}get size(){return this.stack.length}}const te=new se;class ne{constructor(){l(this,"$start",{current:null});l(this,"$end",{current:null});l(this,"isShiftTab",!1);l(this,"latestFocus",null);l(this,"returnFocus",null);l(this,"reset",()=>{this.latestFocus=null,this.returnFocus=null})}get start(){return this.$start.current}get end(){return this.$end.current}}function oe(){const e=z(()=>new ne);return{refs:e,handleCleanup:()=>{e.latestFocus=null,e.returnFocus=null},handleFocusTrap:r=>{const a=c=>{const u=ee(e.start,e.end);if(!u.length||!c)return;const d=r.activeElement;if(d!==e.start&&d!==e.end){if(u.some(f=>f===c||f.contains(c))){e.latestFocus=c;return}if(e.latestFocus)return E(e.latestFocus)}E(e.isShiftTab?e.end:e.start)},n=c=>{e.isShiftTab=c.key===_.tab&&c.shiftKey,a(c.target)},y=c=>{c.stopImmediatePropagation(),a(c.target)};return te.register(r,{onFocusIn:y,onKeyDown:n})}}}function ae(e,s){const{active:t,children:r,onExit:a}=e,{refs:n,handleCleanup:y,handleFocusTrap:c}=oe();p.useImperativeHandle(s,()=>({focus:()=>{E(n.start)}}));const u=L(()=>{if(!t)return;const d=A(n.start);n.returnFocus=d.activeElement;const f=c(d);return()=>{f(),a==null||a(n.returnFocus),y()}});return p.useEffect(()=>u(),[t,u]),p.useEffect(()=>()=>{n.reset()},[n]),o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:n.$start,style:S,tabIndex:t?0:-1}),r,o.jsx("div",{ref:n.$end,style:S,tabIndex:t?0:-1})]})}const re=p.forwardRef(ae);function ce(e,s,t){const{className:r,classNames:a={}}=s;return{root:m(e,t==null?void 0:t.className,r,a.root),body:m(`${e}__body`,a.body),closeBtn:m(`${e}__close-btn`,a.closeBtn),footer:m(`${e}__footer`,a.footer),header:m(`${e}__header`,a.header),main:m(`${e}__main`,a.main)}}const ie={closeOnEscape:!0,closable:!0,mask:!0,maskClosable:!0,returnFocus:!0},le=["getContainer","mask","isOpen","transitions","keepMounted","unmountOnExit","zIndex"];function ue(e){const s=q(e,ie),{children:t,footer:r,modalRender:a,onCancel:n,onOk:y,isOpen:c,title:u,transitions:d={}}=s,{modal:f}=H.useState(),g=p.useRef(null),C=p.useRef(null),j=p.useId(),F=J(),b=`${F}-modal`,h=ce(b,s,f),k=G(s,f),[de,O]=U(s,f,{closeIconRender:i=>o.jsx("button",{className:h.closeBtn,style:k.closeBtn,"aria-label":"close",type:"button",onClick:n,children:i})}),R=s.closeOnEscape?i=>{i.key===_.esc&&(i.stopPropagation(),n==null||n())}:void 0,B=!s.maskClosable||!s.mask?void 0:i=>{i.target&&i.target===g.current&&(n==null||n())},D=s.returnFocus?i=>{const x=i;x&&T(x.focus)&&x.focus()}:void 0,w=o.jsxs("div",{className:h.main,style:k.main,children:[O,o.jsx("div",{className:h.header,style:k.header,children:!Q(u)&&o.jsx("span",{className:`${b}__title`,id:j,children:u})}),o.jsx("div",{className:h.body,style:k.body,children:t}),!V(r)&&o.jsxs("div",{className:h.footer,style:k.footer,children:[o.jsx(v,{onClick:n,children:"取消"}),o.jsx(v,{variant:"filled",onClick:y,children:"确定"})]})]});return o.jsx(X,{...W(s,le),classNames:{mask:`${b}-mask`},transitions:{content:I(d.content,`${F}-zoom-in`),mask:I(d.mask,`${F}-fade-in`)},onEnter:()=>{var i;Y(g.current),(i=C.current)==null||i.focus()},onEntered:()=>{},onExit:()=>{},onExited:()=>{Z(g.current)},children:(i,x)=>o.jsx("div",{ref:g,className:`${b}-wrapper`,tabIndex:-1,onClick:B,onKeyDown:R,children:o.jsx("div",{ref:i,className:m(h.root,x),style:k.root,"aria-labelledby":u?j:void 0,"aria-modal":"true",role:"dialog",children:o.jsx(re,{ref:C,active:c,onExit:D,children:T(a)?a(w):w})})})})}function be(){const[e,s]=p.useState(!1),t=()=>{s(!0)},r=()=>{s(!1)};return o.jsxs(o.Fragment,{children:[o.jsx(v,{onClick:t,children:"open"}),o.jsx(ue,{isOpen:e,onCancel:r,children:o.jsx("div",{children:"12331141341"})})]})}export{be as A};
