var L=Object.defineProperty;var q=(e,t,s)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var l=(e,t,s)=>q(e,typeof t!="symbol"?t+"":t,s);import{n as _,u as z,B as N}from"./index-DoajXrrx.js";import{g as H,r as v,K as I,L as w,B as U,w as S,q as Q,M as V,N as W,j as o,c as x,C as G,a as J,b as X,n as j,i as Y,I as Z,f as T}from"./index-D5yQv7SO.js";import{k as O}from"./keyboard-DDjTZLpe.js";import{u as tt}from"./index-BUA0V5W2.js";import{p as et}from"./pick-BK4giCUn.js";import{O as st}from"./index-Bmqa16rF.js";function nt(e,t=""){e&&e.style.setProperty("display",t==="none"?"":t)}function ot(e){e&&e.style.setProperty("display","none")}const at=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"].join(","),C={position:"fixed",overflow:"hidden",width:0,height:0,top:-1,left:-1,padding:0};let E=[],D=_,A=_;function rt(e){const t=s=>r=>{const n=w(E,-1);n&&n[s](r)};D=I(e,"keydown",t("onKeyDown"),!0),A=I(e,"focusin",t("onFocusIn"))}class ct{constructor(){l(this,"$content",{current:null});l(this,"$end",{current:null});l(this,"$start",{current:null});l(this,"isShiftTab",!1);l(this,"latestFocus",null);l(this,"returnFocus",null)}}class it{constructor(t){l(this,"focusElement",t=>{t&&t.focus({preventScroll:!0})});l(this,"onCleanup",()=>{this.states.latestFocus=null,this.states.returnFocus=null});l(this,"onFocusTrap",(t,s)=>{const a={onFocusIn:c=>{c.stopImmediatePropagation();const f=c.target,{$content:i,$end:F,$start:h,isShiftTab:p,latestFocus:y}=this.states,m=i.current;if(!m||!f)return;const b=t.activeElement;if(b!==h.current&&b!==F.current){if(m.contains(f))return this.setLatestFocus(f);if(y)return this.focusElement(y)}const u=s(m);u.length&&this.focusElement(w(u,p?-1:0))},onKeyDown:c=>{this.states.isShiftTab=c.key===O.tab&&c.shiftKey}};return E.push(a),E.length===1&&rt(t),()=>{E=E.filter(c=>c!==a),E.length||(A(),D())}});l(this,"setLatestFocus",t=>{this.states.latestFocus=t});l(this,"setReturnFocus",t=>{this.states.returnFocus=t});this.states=t}}function lt(){const e=H(()=>new ct);return{actions:v.useMemo(()=>new it(e),[e]),states:e}}function ut(e){const t=e.getAttribute("contenteditable");return t===""||t==="true"}function dt(e){const t=e;return t.tagName==="INPUT"&&t.type==="hidden"}function ft(e){const t=e.getAttribute("tabindex")||"";return!Number.isNaN(Number.parseInt(t,10))}function mt(e){const t=e.tabIndex;if(t<0){const s=/^AUDIO|VIDEO|DETAILS$/.test(e.tagName);if((ut(e)||s)&&!ft(e))return 0}return t}function P(e,t){if(t.has(e))return t.get(e);const{display:s,visibility:r}=U(e);let n=s==="none"||r==="hidden";const a=e.parentElement;return n=!n&&a?P(a,t):n,t.set(e,n),n}function pt(e){return e.disabled||dt(e)?!1:mt(e)>=0}function bt(e){const t=e.querySelectorAll(at),s=new WeakMap;return Array.from(t).filter(r=>!P(r,s)&&pt(r))}const ht={getTabbable:bt};function yt(e){const t=S(e,ht),{active:s,children:r,getTabbable:n,onEnter:a,onExit:c}=t,{actions:f,states:i}=lt(),F=z(i.$content,r.ref),h=Q(y=>{if(!y||!i.$content||!n)return;const m=V(i.$start.current);f.setReturnFocus(m.activeElement);const b=W(()=>{f.focusElement(i.$start.current),a==null||a()}),u=f.onFocusTrap(m,n);return()=>{b(),u(),c==null||c(i.returnFocus),f.onCleanup()}});v.useEffect(()=>h(s),[s,h]);const p=s?0:-1;return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:i.$start,style:C,tabIndex:p}),v.cloneElement(r,{ref:F}),o.jsx("div",{ref:i.$end,style:C,tabIndex:p})]})}function xt(e,t,s){const{className:r,classNames:n={}}=t;return{root:x(e,s==null?void 0:s.className,r,n.root),body:x(`${e}__body`,n.body),closeBtn:x(`${e}__close-btn`,n.closeBtn),footer:x(`${e}__footer`,n.footer),header:x(`${e}__header`,n.header),main:x(`${e}__main`,n.main)}}const Ft={closeOnEscape:!0,closable:!0,mask:!0,maskClosable:!0,returnFocus:!0},gt=["getContainer","mask","isOpen","transitions","keepMounted","unmountOnExit","zIndex"];function kt(e){const t=S(e,Ft),{children:s,footer:r,modalRender:n,onCancel:a,onOk:c,isOpen:f,title:i,transitions:F={}}=t,{modal:h}=G.useState(),p=v.useRef(null),y=v.useId(),m=J(),b=`${m}-modal`,u=xt(b,t,h),g=X(t,h),[Et,B]=tt(t,h,{closeIconRender:d=>o.jsx("button",{className:u.closeBtn,style:g.closeBtn,"aria-label":"close",type:"button",onClick:a,children:d})}),K=t.closeOnEscape?d=>{d.key===O.esc&&(d.stopPropagation(),a==null||a())}:void 0,M=!t.maskClosable||!t.mask?void 0:d=>{d.target&&d.target===p.current&&(a==null||a())},R=t.returnFocus?d=>{const k=d;k&&j(k.focus)&&k.focus()}:void 0,$=o.jsxs("div",{className:u.main,style:g.main,children:[B,o.jsx("div",{className:u.header,style:g.header,children:!Y(i)&&o.jsx("span",{className:`${b}__title`,id:y,children:i})}),o.jsx("div",{className:u.body,style:g.body,children:s}),!Z(r)&&o.jsxs("div",{className:u.footer,style:g.footer,children:[o.jsx(N,{onClick:a,children:"取消"}),o.jsx(N,{variant:"filled",onClick:c,children:"确定"})]})]});return o.jsx(st,{...et(t,gt),classNames:{mask:`${b}-mask`},transitions:{content:T(F.content,`${m}-zoom-in`),mask:T(F.mask,`${m}-fade-in`)},onEnter:()=>{nt(p.current)},onEntered:()=>{},onExit:()=>{},onExited:()=>{ot(p.current)},children:(d,k)=>o.jsx("div",{ref:p,className:`${b}-wrapper`,tabIndex:-1,onClick:M,onKeyDown:K,children:o.jsx("div",{ref:d,className:x(u.root,k.className),style:{...g.root,...k.style},"aria-labelledby":i?y:void 0,"aria-modal":"true",role:"dialog",children:o.jsx(yt,{active:f,onExit:R,children:j(n)?n($):$})})})})}function _t(){const[e,t]=v.useState(!1),s=()=>{t(!0)},r=()=>{t(!1)};return o.jsxs(o.Fragment,{children:[o.jsx(N,{onClick:s,children:"open"}),o.jsx(kt,{isOpen:e,onOk:r,onCancel:r,children:o.jsx("div",{children:"12331141341"})})]})}export{_t as A};
