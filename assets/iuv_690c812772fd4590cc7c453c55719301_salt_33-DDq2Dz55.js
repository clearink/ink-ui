var P=Object.defineProperty;var R=(t,s,e)=>s in t?P(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var i=(t,s,e)=>R(t,typeof s!="symbol"?s+"":s,e);import{n as C,B as E}from"./index-g7ZNuUhb.js";import{G as N,I as K,g as z,r as p,q as A,J as L,j as o,c as m,w as q,C as G,a as H,b as J,n as I,i as Q,f as S}from"./index-CihyO-ZF.js";import{k as _}from"./keyboard-DDjTZLpe.js";import{u as U}from"./index-DiVYil1r.js";import{i as V}from"./is-null-D6OXYL3N.js";import{p as W}from"./pick-BK4giCUn.js";import{O as X}from"./index-C7BdX0vq.js";function Y(t,s=""){t&&t.style.setProperty("display",s==="none"?"":s)}function Z(t){t&&t.style.setProperty("display","none")}const T={position:"fixed",overflow:"hidden",width:0,height:0,top:-1,left:-1,padding:0};function $(t){t&&t.focus({preventScroll:!0})}function ss(t,s){let e=t.nextElementSibling;const r=[];for(;e&&e!==s;)e&&r.push(e),e=(e==null?void 0:e.nextElementSibling)||null;return r}class ts{constructor(){i(this,"stack",[]);i(this,"keydownCleanup",C);i(this,"focusinCleanup",C);i(this,"init",s=>{const e=r=>a=>{const n=K(this.stack,-1);n&&n[r](a)};this.keydownCleanup=N(s,"keydown",e("onKeyDown"),!0),this.focusinCleanup=N(s,"focusin",e("onFocusIn"))});i(this,"cleanup",()=>{this.keydownCleanup(),this.focusinCleanup()});i(this,"register",(s,e)=>(this.stack.length||this.init(s),this.stack.push(e),()=>{this.stack=this.stack.filter(r=>r!==e),this.stack.length||this.cleanup()}))}get size(){return this.stack.length}}const es=new ts;class ns{constructor(){i(this,"$start",{current:null});i(this,"$end",{current:null});i(this,"isShiftTab",!1);i(this,"latestFocus",null);i(this,"returnFocus",null)}}class os{constructor(s){i(this,"handleCleanup",()=>{this.states.latestFocus=null,this.states.returnFocus=null});i(this,"handleFocusTrap",s=>{const e=n=>{const{$start:u,$end:d,latestFocus:l,isShiftTab:h}=this.states,k=ss(u.current,d.current);if(!k.length||!n)return;const f=s.activeElement;if(f!==u.current&&f!==d.current){if(k.some(g=>g.contains(n)||g===n)){this.states.latestFocus=n;return}if(l)return $(l)}$(h?d.current:u.current)},r=n=>{this.states.isShiftTab=n.key===_.tab&&n.shiftKey,e(n.target)},a=n=>{n.stopImmediatePropagation(),e(n.target)};return es.register(s,{onFocusIn:a,onKeyDown:r})});this.states=s}}function as(){const t=z(()=>new ns),s=p.useMemo(()=>new os(t),[t]);return{states:t,actions:s}}function rs(t,s){const{active:e,children:r,onExit:a}=t,{states:n,actions:u}=as();p.useImperativeHandle(s,()=>({focus:()=>{$(n.$start.current)}}));const d=A(()=>{if(!e)return;const l=L(n.$start.current);n.returnFocus=l.activeElement;const h=u.handleFocusTrap(l);return()=>{h(),a==null||a(n.returnFocus),u.handleCleanup()}});return p.useEffect(()=>d(),[e,d]),o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:n.$start,style:T,tabIndex:e?0:-1}),r,o.jsx("div",{ref:n.$end,style:T,tabIndex:e?0:-1})]})}const cs=p.forwardRef(rs);function is(t,s,e){const{className:r,classNames:a={}}=s;return{root:m(t,e==null?void 0:e.className,r,a.root),body:m(`${t}__body`,a.body),closeBtn:m(`${t}__close-btn`,a.closeBtn),footer:m(`${t}__footer`,a.footer),header:m(`${t}__header`,a.header),main:m(`${t}__main`,a.main)}}const ls={closeOnEscape:!0,closable:!0,mask:!0,maskClosable:!0,returnFocus:!0},us=["getContainer","mask","isOpen","transitions","keepMounted","unmountOnExit","zIndex"];function ds(t){const s=q(t,ls),{children:e,footer:r,modalRender:a,onCancel:n,onOk:u,isOpen:d,title:l,transitions:h={}}=s,{modal:k}=G.useState(),f=p.useRef(null),g=p.useRef(null),j=p.useId(),F=H(),v=`${F}-modal`,y=is(v,s,k),x=J(s,k),[ps,O]=U(s,k,{closeIconRender:c=>o.jsx("button",{className:y.closeBtn,style:x.closeBtn,"aria-label":"close",type:"button",onClick:n,children:c})}),M=s.closeOnEscape?c=>{c.key===_.esc&&(c.stopPropagation(),n==null||n())}:void 0,B=!s.maskClosable||!s.mask?void 0:c=>{c.target&&c.target===f.current&&(n==null||n())},D=s.returnFocus?c=>{const b=c;b&&I(b.focus)&&b.focus()}:void 0,w=o.jsxs("div",{className:y.main,style:x.main,children:[O,o.jsx("div",{className:y.header,style:x.header,children:!Q(l)&&o.jsx("span",{className:`${v}__title`,id:j,children:l})}),o.jsx("div",{className:y.body,style:x.body,children:e}),!V(r)&&o.jsxs("div",{className:y.footer,style:x.footer,children:[o.jsx(E,{onClick:n,children:"取消"}),o.jsx(E,{variant:"filled",onClick:u,children:"确定"})]})]});return o.jsx(X,{...W(s,us),classNames:{mask:`${v}-mask`},transitions:{content:S(h.content,`${F}-zoom-in`),mask:S(h.mask,`${F}-fade-in`)},onEnter:()=>{var c;Y(f.current),(c=g.current)==null||c.focus()},onEntered:()=>{},onExit:()=>{},onExited:()=>{Z(f.current)},children:(c,b)=>o.jsx("div",{ref:f,className:`${v}-wrapper`,tabIndex:-1,onClick:B,onKeyDown:M,children:o.jsx("div",{ref:c,className:m(y.root,b.className),style:{...x.root,...b.style},"aria-labelledby":l?j:void 0,"aria-modal":"true",role:"dialog",children:o.jsx(cs,{ref:g,active:d,onExit:D,children:I(a)?a(w):w})})})})}function vs(){const[t,s]=p.useState(!1),e=()=>{s(!0)},r=()=>{s(!1)};return o.jsxs(o.Fragment,{children:[o.jsx(E,{onClick:e,children:"open"}),o.jsx(ds,{isOpen:t,onCancel:r,children:o.jsx("div",{children:"12331141341"})})]})}export{vs as A};
